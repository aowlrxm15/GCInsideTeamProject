<!-- 2023/03/22 // 김재준 // 어드민 갤러리 개설 신청 -->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="~{fragment/head_fragment::adminHead}"></th:block>
    <link rel="stylesheet" th:href="@{/css/popup.css}">
</head>
<body>
<div class="gcwrap">

    <header th:replace="~{fragment/header_fragment::adminHeader}"></header>

    <main id="container" class="admin_main">
        <div class="main_content">
            <div class="admin_left">

                <!-- 사이드 gnb -->
                <aside th:replace="~{fragment/gnb_fragment::adminGnb}"></aside>

            </div>
                <!-- 개설 이유 글 자르기 -->
                <script>
                    function truncateText(selector, maxLength) {
                      var elements = document.querySelectorAll(selector);
                      for (var i = 0; i < elements.length; i++) {
                        var element = elements[i];
                        var text = element.textContent;
                        if (text.length > maxLength) {
                          var truncated = text.substring(0, maxLength) + '...';
                          element.textContent = truncated;
                        }
                      }
                    }
                  
                    document.addEventListener('DOMContentLoaded', function() {
                      truncateText('.truncate', 7); // 적용할 클래스와 최대 길이 설정
                    });
                </script>

                <!-- 상세보기 / 개설관리 팝업 창 -->
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        var showDetailButtons = document.querySelectorAll('.show-details');
                        for (var i = 0; i < showDetailButtons.length; i++) {
                            showDetailButtons[i].addEventListener('click', showDetails);
                        }

                        var showApprovalButtons = document.querySelectorAll('.approval');
                        for (var i = 0; i < showApprovalButtons.length; i++) {
                            showApprovalButtons[i].addEventListener('click', showApprovalPopup);
                        }

                        var closeApprovalPopupButton = document.querySelector('.close-approval-popup');
                        closeApprovalPopupButton.addEventListener('click', closeApprovalPopup);

                        var closePopupButton = document.querySelector('.close-popup');
                        closePopupButton.addEventListener('click', closePopup);

                    });

                    function showDetails(event) {
                        event.preventDefault();
                        var content = event.target.parentNode.parentNode.querySelector('.truncate').dataset.fullText;
                        var popup = document.querySelector('.popup');
                        var popupContent = document.querySelector('.popup-content');
                        popupContent.innerHTML = content; // textContent 대신 innerHTML 사용
                        popup.style.display = 'block';
                    }

                    function showApprovalPopup(event) {
                        event.preventDefault();
                        var popup = document.querySelector('.approval-popup');
                        popup.style.display = 'block';
                    }

                    function closePopup() {
                        var popup = document.querySelector('.popup');
                        popup.style.display = 'none';
                    }

                    function closeApprovalPopup() {
                        var popup = document.querySelector('.approval-popup');
                        popup.style.display = 'none';
                    }
                </script>
  
                <div class="admin_right">
                    <section class="admin_main_info">
                        <div class="cont_head"><h2>갤러리 개설 신청</h2></div>
                        <div class="admin_info_content">
                            <div class="member_search_box">
                                <select class="admin_member_search_select_box" id="member_search_select_box" name="select-box">
                                    <option value="option1">갤러리명</option>
                                    <option value="option2">아이디</option>
                                    <option value="option3">신청자</option>
                                </select>
                                <input type="text" id="input-box" name="input-box" placeholder="키워드 입력">
                                <button type="button" class="btn_lightgreen" id="submit-button">검색</button>
                            </div>

                            <!-- 카테고리별 검색 기능 -->
                            <div class="category_search_box">
                                <select class="admin_member_search_select_box" id="category_search_select_box" name="category-select-box">
                                    <option value="">카테고리 전체</option>
                                    <th:block th:each="cate:${cates}">
                                        <option th:data-value="${cate.gell_cate2}" th:text="${cate.gell_cate2_name}"></option>
                                    </th:block>
                                </select>
                                <button type="button" class="btn_lightgreen" id="category-submit-button">검색</button>
                            </div>

                            <table class="admin_table admin_member_list">
                                <colgroup>
                                    <col style="width: 9.2%;">
                                    <col style="width: 14.2%;">
                                    <col style="width: 14.2%;">
                                    <col style="width: 9.2%;">
                                    <col style="width: 14.2%;">
                                    <col style="width: 14.2%;">
                                    <col style="width: 14.8%;">
                                </colgroup>
                                <tr>
                                    <th>신청번호</th>
                                    <th>갤러리 이름</th>
                                    <th>주소값</th>
                                    <th>카테고리</th>
                                    <th>신청일</th>
                                    <th>신청자</th>
                                    <th>갤러리 설명</th>
                                    <th>관리</th>
                                </tr>
                                <tr th:each="list:${list}">
                                    <td></td>
                                    <td th:text="${list.gell_create_name}"></td>
                                    <td th:text="${list.gell_create_address}"></td>
                                    <td th:text="${list.gell_create_cate}"></td>
                                    <td th:text="${#strings.substring(list.gell_create_rdate, 2, 8)}"></td>
                                    <td th:text="${list.gell_create_uid}"></td>
                                    <td><button class="truncate show-details" th:attr="data-full-text=${list.gell_create_reason}" th:text="${list.gell_create_reason}"></button></td>
                                    <td><button class="approval">[개설관리]</button></td>
                                </tr>
                            </table>
                            <div class="popup">
                                <div class="popup-content"></div>
                                <button class="close-popup">닫기</button>
                            </div>
                            <div class="approval-popup" style="display:none;">
                                <h3>갤러리 개설 승인/반려</h3>
                                <p>갤러리 개설 요청을 승인하거나 반려하려면 아래 버튼을 클릭하세요.</p>
                                <button class="approve">승인</button>
                                <button class="reject">반려</button>
                                <button class="close-approval-popup">닫기</button>
                            </div>
                        </div>

                        <!-- 페이징 -->
                        <div class="admin_pageing">
                            <span class="admin_pageing_prev"><a href="#"><&nbsp;이전</a></span>

                            <span class="admin_pageing_num">
                                <a href="#" class="on">1</a>
                                <a href="#">2</a>
                                <a href="#">3</a>
                                <a href="#">4</a>
                                <a href="#">5</a>
                                <a href="#">6</a>
                                <a href="#">7</a>
                                <a href="#">8</a>
                                <a href="#">9</a>
                                <a href="#">10</a>
                            </span>

                            <span class="admin_pageing_next">다음&nbsp;></span>
                        </div>

                    </section>
                </div>
            </div>
        </main>

        <footer class="admin_footer gcfoot">
            <div class="copyright">Copyright ⓒ 2023 gcinside. All rights reserved.</div>
        </footer>
    </div>
</body>
</html>